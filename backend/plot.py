import matplotlib.pyplot as plt

# Size 3 to 25
size = [3, 4, 5, 6, 7, 8, 9, 10, 11, 12 ,13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
our_smith = [  2.076425313949585, 4.090488910675049, 6.8282225131988525, 11.218446493148804,
      15.812009572982788, 21.31871271133423, 28.421658277511597, 36.64220929145813,
      45.8686728477478, 59.294870138168335, 72.20354866981506, 85.19957089424133,
      102.46785140037537, 119.906405210495, 146.5459864139557, 173.90113711357117,
      205.01177501678467, 283.0698275566101, 413.833886384964, 477.24289751052856,
      1056.939037322998, 4047.8909747600555, 5347.9098908901215
    ]
sage_smith =  [
       0.16206026077270508, 0.2035984992980957, 0.37270021438598633, 0.3284637928009033,
       0.40412092208862305, 0.6498053073883057, 0.6672310829162598, 0.7826416492462158,
       0.8900682926177979, 0.9985175132751465, 1.2476534843444824, 1.3700883388519287,
       1.5488977432250977, 1.7212347984313965, 2.395354747772217, 4.047799825668335,
       1.9518587589263916, 3.607682943344116, 4.086221218109131, 5.659216642379761,
       5.198996305465698, 5.757007122039795, 4.9045090675354
   ]
our_hermite = [
        2.364091396331787, 4.905017137527466, 8.928385257720947, 13.989642858505249,
        19.894989728927612, 29.36741542816162, 39.035167932510376, 51.88647770881653,
        64.17065668106079, 81.82034969329834, 102.75686478614807, 121.86689233779907,
        146.11681866645813, 174.47412824630737, 204.48312759399414, 239.81779623031616,
        276.5863924026489, 326.2010054588318, 383.6619641780853, 474.0774657726288,
        565.2949502468109, 712.5214202404022, 962.9764354228973
    ]
sage_hermite = [
        0.7627301216125488, 2.550016164779663, 2.6247854232788086, 1.4240014553070068,
        2.9237425327301025, 3.0591399669647217, 3.285869836807251, 3.4272022247314453,
        3.806929111480713, 3.8678743839263916, 4.146852493286133, 4.389949321746826,
        3.21351957321167, 4.945457696914673, 5.537517070770264, 6.067340850830078,
        6.5953545570373535, 6.987786054611206, 6.044969320297241, 8.055599927902222,
        8.912620544433594, 7.831480026245117, 10.004392862319946
    ]


# 1) Smith Normal Form
plt.plot(size, sage_smith, label='Sage Implementation')
plt.plot(size, our_smith, label='Our Implementation')
plt.yscale('log')
plt.xlabel('Matrix Size (NxN)')
plt.ylabel('Time (s)')
plt.title('Smith Normal Form Comparison of Sage and Our Implementation')
plt.legend()
plt.grid(True)
plt.show()

# 2) Hermite Normal Form

plt.plot(size, sage_hermite, label='Sage Implementation')
plt.plot(size, our_hermite, label='Our Implementation')
plt.yscale('log')
plt.xlabel('Matrix Size (NxN)')
plt.ylabel('Time (s)')
plt.title('Hermite Normal Form Comparison of Sage and Our Implementation')
plt.legend()
plt.grid(True)
plt.show()

# 3) Smith Normal Form vs Hermite Normal Form
plt.plot(size, our_smith, label='Smith Normal Form')
plt.plot(size, our_hermite, label='Hermite Normal Form')
plt.xlabel('Matrix Size (NxN)')
plt.ylabel('Time (s)')
plt.title('Smith Normal Form vs Hermite Normal Form (Our Implementation)')
plt.legend()
plt.grid(True)
plt.show()
